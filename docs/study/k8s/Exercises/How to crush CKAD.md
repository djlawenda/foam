---
type: exercise-note
tags: exercise
foam_template:
    name: exercise-note
    description: Exercise
    filepath: 'new/How to crush CKAD.md'
---
# How to crush CKAD
Note Created: 2023-02-26

## Lab 

> k8s primitives 4%
1. Search for container named "banana-boat" in namespace "pineapple".
   ```console
   kubectl get pods --all-namespaces -o jsonpath="{.items[*].spec.containers[*].image}"
   ```
2. Move pod with the container to namespace "banana".
   create yaml
   remove all unnecessery fields
   replace namespace=banana
   create new pod
   remove old pod

> create pod 3%
1. Create single Pod in ns default with the image nginx:1.22.1. The pod should be named "alphapod" and the container should be named "alphapod-container".
```console
k run alphapod --image=nginx:1.22.1 $drc > alphapod.yaml
vim alphapod.yaml
# update container name
k create -f alphapod.yaml
```

> multicontainer 6%
1. A Tech lead has whipped up a container named "snooper-con" in deployment "snooper" in ns "starfruit". This container mounts a volume and writes logs into  a file called "snooper.log". The YAML for the exisitng deployment is available at snooper.yaml.
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: snooper
  name: snooper
spec:
  replicas: 3
  selector:
    matchLabels:
      app: snooper
  strategy: {}
  template:
    metadata:
      labels:
        app: snooper
    spec:
      containers:
        - image: nginx
          name: snooper-con
          volumeMounts:
            - mountPath: "/data"
              name: myvol
      volumes:
        - name: myvol
          emptyDir:
            sizeLimit: 500Mi
```
2. Inside the deployment, create sidecard container named "kennylogger-con", image busybox:1.31.0. Save your changes as "snooper-new.yaml" but also make sure deployment is running.
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: snooper
  name: snooper
spec:
  replicas: 3
  selector:
    matchLabels:
      app: snooper
  strategy: {}
  template:
    metadata:
      labels:
        app: snooper
    spec:
      containers:
        - name: main-application
          image: nginx
          volumeMounts:
            - name: myvol
              mountPath: /var/log/nginx
        - name: sidecar-container
          image: busybox
          command: ["sh","-c","sleep 5"]
          volumeMounts:
            - name: myvol
              mountPath: /var/log/nginx
      volumes:
        - name: myvol
          emptyDir: {}
```


> deployments 8%
1. In namespace "coconut" there is single pod named "watermelon". Convert the pod into deployment with 5 replicas and deployment name "watermelonslice".
2. Create the deployment and save its YAML under watermelon-deployment.yaml

> deployment rolling wollbacks 4%
1. There is an exsiting deployment named lemon in ns banana. Apparently the current version is broken. Check the deployment history and roll back to version that works.

> jobs and cronjobs 3%
1. Team banan needs a job template located at bananajob.yaml. Thsi job should execute the commands sleep 2 && echo done on image busybox:1.31.0 in namespace banana. Make it execute 3 pods in parallel for total 5 completitions.
2. Every pod generated by bananjob should have the label eatyour: bananas. The job should be named bananjob and the container named banana-bin.

> labels, selectors and annotations 3%
1. Team Melon needs to identify some of their pods in namespace basket. They ask you to add a new lable safe: sound to all pods with and exisitng label type:citrus or type: seedless. All pods with the lablel safe: sound will then be given the annotanion fruit: good for what ails ya

> pv and pvc 10%
1. Create a new pv named strawberry-pv. It should have a cpacity of 2Gi, accessMode RWO, hostPath /Data/Berry and the storageClass exam.
2. Next create a new pvc named strawberry-pvc in namespace straw. It should request 1 Gi storage, accessMode RWO with storage Class exam. PVC and PV should bind.
3. Create new deployment named strawberry-deploy in ns straw. Mound strawberry-pvc as a volume at /tmp/berry. The pod of the deploymentshould be of image nginx:1.7.9

> configmaps 5%
1. Create cm called config-kiwi containing the file web-kiwi.html
2. Create deployment kiwi-deploy to use cm. Confirm that containers are running.

> securityContext 5%
1. Create a pod called nginx with imgae nginx:1.7.9 which forces all processes to run with user ID 1000 and group ID 2000. Set privilage escalation to false.

> resource requirments
1. Create a deployment named apple-deploy with 4 replicas and the image nginx:1.7.9. The containers should be named apple-bin. Each container should have a memory request of 15Mi and memory limit of 30Mi.

> Secrets 4%
1. Adjust an pod named kiwi-secret-pod in namespace kiwi. Create new secret named juicy secret. It contains key/values user=kiwi and pass=aredelicious. Make the content available in the pod kiwi-secret-pod as a env USERKIWI and PASSKIWI. The YAML file for this pod is named fruitbasket.yaml

> serviceAccount 4%
1. Create a deployment named banan-peel with 2 replicas of image ngnx:1.9.1.
2. Team Banan has its own serviceAccount mega-banana-v5. Make the banana-peel deployment pods run under the serviceAccount. the deployment should be in ns banana.

> probes 7%
1. Create a single pod named plumpod in namespace plum of image busybox:1.31.0. Add a readiness probe to this container executing cat /tmp/plumpplum. The probe should initially wait 3 sec and then 6 sec.

> monitor application 4%
1. Get the CPU usage of all pods in the default ns. Find which pod has the highest CPU usage and write the pod name to the premade file cpu-consume.txt.

> Service 4%
1. Team Coconut needs a service project-paradise-svc in namespace coconut. The service should use TCP posrt redirection of 3423:80. This service should expose a single pod named lone-coconut of image nginx:1.91 with the label coconuts-migrate.

> networkPolicy 12%
1. In ns cherry you will find 2 deployments pit and stem. Both deployments are exposed via a service. Make a networkPolicy names cherry-control that prevents outgoing traffic from deployment pit except to that of deployment stem.

## Solution

## Materials